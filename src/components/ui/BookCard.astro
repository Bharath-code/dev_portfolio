---
interface Props {
    title: string;
    author: string;
    status: "recommended" | "read" | "want-to-read";
    genre: string;
    link: string;
    cover?: string;
    rating: number;
    review?: string;
    pages?: number;
    year?: number;
}

const {
    title,
    author,
    status,
    genre,
    link,
    cover,
    rating,
    review,
    pages,
    year,
} = Astro.props;

// Use a curated set of colors for backgrounds instead of just black
const colors = ["#10B981", "#3B82F6", "#F59E0B", "#8B5CF6", "#EF4444"];
const bgColor = colors[Math.abs(title.length) % colors.length];
const fallbackCover = `https://placehold.co/600x800/${bgColor.replace("#", "")}/FFFFFF?text=${encodeURIComponent(title)}`;
const bookCover = cover || fallbackCover;

const statusStyles = {
    recommended:
        "bg-signal-emerald/10 text-signal-emerald border-signal-emerald/20",
    read: "bg-blue-500/10 text-blue-500 border-blue-500/20",
    "want-to-read": "bg-orange-500/10 text-orange-500 border-orange-500/20",
};

const statusLabels = {
    recommended: "Highly Recommended",
    read: "Read",
    "want-to-read": "Reading List",
};
---

<a
    href={link}
    target="_blank"
    rel="noopener noreferrer"
    class="group relative flex flex-col bg-white dark:bg-void-black overflow-hidden transition-all duration-500 hover:z-20 reveal"
>
    <!-- Image Container with Aspect Ratio -->
    <div
        class="aspect-[3/4.5] overflow-hidden bg-gray-100 dark:bg-gray-900 relative"
    >
        <img
            src={bookCover}
            alt={`Cover of ${title}`}
            class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105"
            loading="lazy"
        />

        <!-- Status Badge - Minimalist absolute positioning -->
        <div
            class="absolute top-0 left-0 p-4 w-full flex justify-between items-start"
        >
            <span
                class={`text-[9px] font-black uppercase tracking-[0.2em] px-3 py-1.5 border backdrop-blur-md ${statusStyles[status]}`}
            >
                {statusLabels[status]}
            </span>
        </div>

        <!-- Review Overlay - Appears on hover -->
        {
            review && (
                <div class="absolute inset-0 bg-black/80 backdrop-blur-sm p-8 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <p class="text-white text-sm font-medium leading-relaxed italic text-center">
                        "{review}"
                    </p>
                </div>
            )
        }
    </div>

    <!-- Content -->
    <div
        class="p-8 flex flex-col flex-grow border-x border-b border-black/5 dark:border-white/5 transition-colors group-hover:bg-black/[0.02] dark:group-hover:bg-white/[0.02]"
    >
        <div class="flex justify-between items-start mb-4">
            <span
                class="text-[10px] font-black uppercase tracking-[0.15em] text-black/40 dark:text-white/40"
            >
                {genre}
            </span>
            {
                rating > 0 && (
                    <div class="flex gap-0.5">
                        {[...Array(5)].map((_, i) => (
                            <div
                                class={`w-1.5 h-1.5 rounded-full ${i < rating ? "bg-signal-emerald" : "bg-black/10 dark:bg-white/10"}`}
                            />
                        ))}
                    </div>
                )
            }
        </div>

        <h3
            class="text-2xl font-display leading-[1.1] text-black dark:text-white mb-2 group-hover:text-signal-emerald transition-colors"
        >
            {title}
        </h3>
        <p class="text-sm text-black/60 dark:text-white/60 font-medium mb-6">
            {author}
        </p>

        <!-- Metadata Row -->
        <div
            class="mt-auto pt-6 border-t border-black/5 dark:border-white/5 flex items-center justify-between text-[10px] font-black uppercase tracking-widest text-black/40 dark:text-white/40"
        >
            <div class="flex gap-4">
                {pages && <span>{pages} Pages</span>}
                {year && <span>{year}</span>}
            </div>
            <div class="group-hover:text-signal-emerald transition-colors">
                View
            </div>
        </div>
    </div>
</a>
